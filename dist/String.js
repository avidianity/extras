"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _dayjs = _interopRequireDefault(require("dayjs"));

var _relativeTime = _interopRequireDefault(require("dayjs/plugin/relativeTime"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

_dayjs["default"].extend(_relativeTime["default"]);

var errors = [];

if (typeof String.prototype.toNumber === 'undefined') {
  Object.defineProperty(String.prototype, 'toNumber', {
    enumerable: false,
    configurable: false,
    writable: false,
    value: function value() {
      var parts = this.split('.');

      if (parts.length > 1) {
        var whole = (parts[0].match(/\d/g) || []).join('');
        var decimals = (parts[1].match(/\d/g) || []).join('');
        return Number("".concat(whole, ".").concat(decimals)) || 0;
      }

      var match = this.match(/\d/g);

      if (!match) {
        return 0;
      }

      return Number(match.join('')) || 0;
    }
  });
} else {
  errors.push('toNumber');
}

if (typeof String.prototype.toDayJS === 'undefined') {
  Object.defineProperty(String.prototype, 'toDayJS', {
    enumerable: false,
    configurable: false,
    writable: false,
    value: function value() {
      var instance = (0, _dayjs["default"])(this.toString());

      if (!instance.isValid()) {
        throw new Error('Invalid Date');
      }

      return instance;
    }
  });
} else {
  errors.push('toDayJS');
}

if (typeof String.prototype.toDate === 'undefined') {
  Object.defineProperty(String.prototype, 'toDate', {
    enumerable: false,
    configurable: false,
    writable: false,
    value: function value() {
      var instance = (0, _dayjs["default"])(this.toString());

      if (!instance.isValid()) {
        throw new Error('Invalid Date');
      }

      return instance.toDate();
    }
  });
} else {
  errors.push('toDate');
}

if (typeof String.prototype.fromNow === 'undefined') {
  Object.defineProperty(String.prototype, 'fromNow', {
    enumerable: false,
    configurable: false,
    writable: false,
    value: function value() {
      var instance = (0, _dayjs["default"])(this.toString());

      if (!instance.isValid()) {
        throw new Error('Invalid Date');
      }

      return instance.fromNow();
    }
  });
} else {
  errors.push('fromNow');
}

if (typeof String.random === 'undefined') {
  Object.defineProperty(String, 'random', {
    enumerable: false,
    configurable: false,
    writable: false,
    value: function value(size) {
      var characters = '1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM';
      var results = '';

      for (var x = 0; x < size; x++) {
        results += characters.charAt(Math.floor(Math.random() * characters.length));
      }

      return results;
    }
  });
} else {
  errors.push('random');
}

if (typeof String.prototype.ucfirst === 'undefined') {
  Object.defineProperty(String.prototype, 'ucfirst', {
    enumerable: false,
    configurable: false,
    writable: false,
    value: function value() {
      var fragments = this.split('');

      if (fragments.length > 0) {
        fragments[0] = fragments[0].toUpperCase();
      }

      return fragments.join('');
    }
  });
} else {
  errors.push('ucfirst');
}

if (typeof String.prototype.ucwords === 'undefined') {
  Object.defineProperty(String.prototype, 'ucwords', {
    enumerable: false,
    configurable: false,
    writable: false,
    value: function value() {
      return this.split(' ').map(function (string) {
        var fragments = string.split('');

        if (fragments.length > 0) {
          fragments[0] = fragments[0].toUpperCase();
        }

        return fragments.join('');
      }).join(' ');
    }
  });
} else {
  errors.push('ucwords');
}

if (errors.length > 0) {
  console.error("@avidian/extras:String: Unable to patch the following methods - ".concat(errors.join(', ')));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9TdHJpbmcudHMiXSwibmFtZXMiOlsiZGF5anMiLCJleHRlbmQiLCJyZWxhdGl2ZVRpbWUiLCJlcnJvcnMiLCJTdHJpbmciLCJwcm90b3R5cGUiLCJ0b051bWJlciIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwidmFsdWUiLCJwYXJ0cyIsInNwbGl0IiwibGVuZ3RoIiwid2hvbGUiLCJtYXRjaCIsImpvaW4iLCJkZWNpbWFscyIsIk51bWJlciIsInB1c2giLCJ0b0RheUpTIiwiaW5zdGFuY2UiLCJ0b1N0cmluZyIsImlzVmFsaWQiLCJFcnJvciIsInRvRGF0ZSIsImZyb21Ob3ciLCJyYW5kb20iLCJzaXplIiwiY2hhcmFjdGVycyIsInJlc3VsdHMiLCJ4IiwiY2hhckF0IiwiTWF0aCIsImZsb29yIiwidWNmaXJzdCIsImZyYWdtZW50cyIsInRvVXBwZXJDYXNlIiwidWN3b3JkcyIsIm1hcCIsInN0cmluZyIsImNvbnNvbGUiLCJlcnJvciJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7O0FBQ0E7Ozs7QUFnQkFBLGtCQUFNQyxNQUFOLENBQWFDLHdCQUFiOztBQUVBLElBQU1DLE1BQWdCLEdBQUcsRUFBekI7O0FBRUEsSUFBSSxPQUFPQyxNQUFNLENBQUNDLFNBQVAsQ0FBaUJDLFFBQXhCLEtBQXFDLFdBQXpDLEVBQXNEO0FBQ2xEQyxFQUFBQSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JKLE1BQU0sQ0FBQ0MsU0FBN0IsRUFBd0MsVUFBeEMsRUFBb0Q7QUFDaERJLElBQUFBLFVBQVUsRUFBRSxLQURvQztBQUVoREMsSUFBQUEsWUFBWSxFQUFFLEtBRmtDO0FBR2hEQyxJQUFBQSxRQUFRLEVBQUUsS0FIc0M7QUFJaERDLElBQUFBLEtBQUssRUFBRSxpQkFBWTtBQUNmLFVBQU1DLEtBQUssR0FBRyxLQUFLQyxLQUFMLENBQVcsR0FBWCxDQUFkOztBQUNBLFVBQUlELEtBQUssQ0FB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dkIsRUFBMEI7QUFDdEJ1QixVQUFBQSxTQUFTLENBQUMsQ0FBRCxDQUFULEdBQWVBLFNBQVMsQ0FBQyxDQUFELENBQVQsQ0FBYUMsV0FBYixFQUFmO0FBQ0g7O0FBRUQsZUFBT0QsU0FBUyxDQUFDcEIsSUFBVixDQUFlLEVBQWYsQ0FBUDtBQUNILE9BVEUsRUFVRkEsSUFWRSxDQVVHLEdBVkgsQ0FBUDtBQVdIO0FBaEI4QyxHQUFuRDtBQWtCSCxDQW5CRCxNQW1CTztBQUNIZixFQUFBQSxNQUFNLENBQUNrQixJQUFQLENBQVksU0FBWjtBQUNIOztBQUVELElBQUlsQixNQUFNLENBQUNZLE1BQVAsR0FBZ0IsQ0FBcEIsRUFBdUI7QUFDbkI0QixFQUFBQSxPQUFPLENBQUNDLEtBQVIsMkVBQWlGekMsTUFBTSxDQUFDZSxJQUFQLENBQVksSUFBWixDQUFqRjtBQUNIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGRheWpzLCB7IERheWpzIH0gZnJvbSAnZGF5anMnO1xuaW1wb3J0IHJlbGF0aXZlVGltZSBmcm9tICdkYXlqcy9wbHVnaW4vcmVsYXRpdmVUaW1lJztcblxuZGVjbGFyZSBnbG9iYWwge1xuICAgIGludGVyZmFjZSBTdHJpbmcge1xuICAgICAgICB0b051bWJlcigpOiBudW1iZXI7XG4gICAgICAgIHRvRGF0ZSgpOiBEYXRlO1xuICAgICAgICB0b0RheUpTKCk6IERheWpzO1xuICAgICAgICBmcm9tTm93KCk6IHN0cmluZztcbiAgICAgICAgdWNmaXJzdCgpOiBzdHJpbmc7XG4gICAgICAgIHVjd29yZHMoKTogc3RyaW5nO1xuICAgIH1cbiAgICBpbnRlcmZhY2UgU3RyaW5nQ29uc3RydWN0b3Ige1xuICAgICAgICByYW5kb20oc2l6ZT86IG51bWJlcik6IHN0cmluZztcbiAgICB9XG59XG5cbmRheWpzLmV4dGVuZChyZWxhdGl2ZVRpbWUpO1xuXG5jb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG5cbmlmICh0eXBlb2YgU3RyaW5nLnByb3RvdHlwZS50b051bWJlciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ3RvTnVtYmVyJywge1xuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc3QgcGFydHMgPSB0aGlzLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHdob2xlID0gKHBhcnRzWzBdLm1hdGNoKC9cXGQvZykgfHwgW10pLmpvaW4oJycpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRlY2ltYWxzID0gKHBhcnRzWzFdLm1hdGNoKC9cXGQvZykgfHwgW10pLmpvaW4oJycpO1xuICAgICAgICAgICAgICAgIHJldHVybiBOdW1iZXIoYCR7d2hvbGV9LiR7ZGVjaW1hbHN9YCkgfHwgMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gdGhpcy5tYXRjaCgvXFxkL2cpO1xuICAgICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE51bWJlcihtYXRjaC5qb2luKCcnKSkgfHwgMDtcbiAgICAgICAgfSxcbiAgICB9KTtcbn0gZWxzZSB7XG4gICAgZXJyb3JzLnB1c2goJ3RvTnVtYmVyJyk7XG59XG5cbmlmICh0eXBlb2YgU3RyaW5nLnByb3RvdHlwZS50b0RheUpTID09PSAndW5kZWZpbmVkJykge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAndG9EYXlKUycsIHtcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gZGF5anModGhpcy50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGlmICghaW5zdGFuY2UuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIERhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICAgICAgfSxcbiAgICB9KTtcbn0gZWxzZSB7XG4gICAgZXJyb3JzLnB1c2goJ3RvRGF5SlMnKTtcbn1cblxuaWYgKHR5cGVvZiBTdHJpbmcucHJvdG90eXBlLnRvRGF0ZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ3RvRGF0ZScsIHtcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gZGF5anModGhpcy50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGlmICghaW5zdGFuY2UuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIERhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZS50b0RhdGUoKTtcbiAgICAgICAgfSxcbiAgICB9KTtcbn0gZWxzZSB7XG4gICAgZXJyb3JzLnB1c2goJ3RvRGF0ZScpO1xufVxuXG5pZiAodHlwZW9mIFN0cmluZy5wcm90b3R5cGUuZnJvbU5vdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3RyaW5nLnByb3RvdHlwZSwgJ2Zyb21Ob3cnLCB7XG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IGRheWpzKHRoaXMudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICBpZiAoIWluc3RhbmNlLmlzVmFsaWQoKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBEYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaW5zdGFuY2UuZnJvbU5vdygpO1xuICAgICAgICB9LFxuICAgIH0pO1xufSBlbHNlIHtcbiAgICBlcnJvcnMucHVzaCgnZnJvbU5vdycpO1xufVxuXG5pZiAodHlwZW9mIFN0cmluZy5yYW5kb20gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZywgJ3JhbmRvbScsIHtcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIChzaXplOiBudW1iZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGNoYXJhY3RlcnMgPSAnMTIzNDU2Nzg5MHF3ZXJ0eXVpb3Bhc2RmZ2hqa2x6eGN2Ym5tUVdFUlRZVUlPUEFTREZHSEpLTFpYQ1ZCTk0nO1xuICAgICAgICAgICAgbGV0IHJlc3VsdHMgPSAnJztcblxuICAgICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBzaXplOyB4KyspIHtcbiAgICAgICAgICAgICAgICByZXN1bHRzICs9IGNoYXJhY3RlcnMuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYXJhY3RlcnMubGVuZ3RoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICB9LFxuICAgIH0pO1xufSBlbHNlIHtcbiAgICBlcnJvcnMucHVzaCgncmFuZG9tJyk7XG59XG5cbmlmICh0eXBlb2YgU3RyaW5nLnByb3RvdHlwZS51Y2ZpcnN0ID09PSAndW5kZWZpbmVkJykge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmcucHJvdG90eXBlLCAndWNmaXJzdCcsIHtcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnN0IGZyYWdtZW50cyA9IHRoaXMuc3BsaXQoJycpO1xuXG4gICAgICAgICAgICBpZiAoZnJhZ21lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmcmFnbWVudHNbMF0gPSBmcmFnbWVudHNbMF0udG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZyYWdtZW50cy5qb2luKCcnKTtcbiAgICAgICAgfSxcbiAgICB9KTtcbn0gZWxzZSB7XG4gICAgZXJyb3JzLnB1c2goJ3VjZmlyc3QnKTtcbn1cblxuaWYgKHR5cGVvZiBTdHJpbmcucHJvdG90eXBlLnVjd29yZHMgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZy5wcm90b3R5cGUsICd1Y3dvcmRzJywge1xuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3BsaXQoJyAnKVxuICAgICAgICAgICAgICAgIC5tYXAoKHN0cmluZzogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyYWdtZW50cyA9IHN0cmluZy5zcGxpdCgnJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyYWdtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmcmFnbWVudHNbMF0gPSBmcmFnbWVudHNbMF0udG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmcmFnbWVudHMuam9pbignJyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuam9pbignICcpO1xuICAgICAgICB9LFxuICAgIH0pO1xufSBlbHNlIHtcbiAgICBlcnJvcnMucHVzaCgndWN3b3JkcycpO1xufVxuXG5pZiAoZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICBjb25zb2xlLmVycm9yKGBAYXZpZGlhbi9leHRyYXM6U3RyaW5nOiBVbmFibGUgdG8gcGF0Y2ggdGhlIGZvbGxvd2luZyBtZXRob2RzIC0gJHtlcnJvcnMuam9pbignLCAnKX1gKTtcbn1cblxuZXhwb3J0IHt9O1xuIl19